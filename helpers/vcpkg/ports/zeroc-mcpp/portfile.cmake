include(vcpkg_common_functions)

vcpkg_from_github(
   OUT_SOURCE_PATH SOURCE_PATH
   REPO zeroc-ice/mcpp
   REF v2.7.2.14
   SHA512 E50287DA46C319F77C6507281D67EBFA0654FD0A907A0F0910F1A6246085934887062EE64A93830257A399F014F99DB7AE6173069BFE94F2C7D069DEDB039685
   HEAD_REF master
)

file(COPY ${CMAKE_CURRENT_LIST_DIR}/CMakeLists.txt DESTINATION ${SOURCE_PATH})

vcpkg_check_linkage(ONLY_STATIC_LIBRARY)

vcpkg_configure_cmake(
   SOURCE_PATH ${SOURCE_PATH}
   PREFER_NINJA
)

vcpkg_install_cmake()

file(
   INSTALL 
      ${SOURCE_PATH}/config.h 
	   ${SOURCE_PATH}/mcpp_lib.h
	   ${SOURCE_PATH}/mcpp_out.h
   
   DESTINATION 
      ${CURRENT_PACKAGES_DIR}/include)
file(INSTALL ${SOURCE_PATH}/LICENSE DESTINATION ${CURRENT_PACKAGES_DIR}/share/zeroc-mcpp RENAME copyright)
